{"version":3,"file":"cards/index.js","mappings":"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","sources":["webpack://dgwltd/./src/blocks/src/cards/index.scss","webpack://dgwltd/external window [\"wp\",\"data\"]","webpack://dgwltd/external window [\"wp\",\"i18n\"]","webpack://dgwltd/webpack/bootstrap","webpack://dgwltd/webpack/runtime/compat get default export","webpack://dgwltd/webpack/runtime/define property getters","webpack://dgwltd/webpack/runtime/hasOwnProperty shorthand","webpack://dgwltd/webpack/runtime/make namespace object","webpack://dgwltd/./src/blocks/src/cards/index.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// Import CSS\nimport './index.scss';\n\n// Import dependencies\n\n// Import wp-i18n to internationalize the block\nimport { __ } from '@wordpress/i18n';\n\n// Import select from wp-data to access the post meta\nimport { select, subscribe } from '@wordpress/data';\n\n// Create a function\n(function () {\n  'use strict';\n\n  const updateFeaturedCards = (block, featured_id, saved_field_id) => {\n    \n    let cards = [];\n    let featured = [];\n    let cards_options = block.querySelectorAll('.values [data-id]');\n    let featured_input = block.parentNode.querySelector('.acf-field-' + featured_id + ' .acf-input select');\n    let featured_input_options = block.parentNode.querySelectorAll('.acf-field-' + featured_id + ' .acf-input select option');\n    let featured_card = acf.getField(saved_field_id);\n\n    // Update cards array\n    Array.prototype.forEach.call(cards_options, function (item) {\n      let card = { id: item.getAttribute('data-id') };\n      cards.push(card);\n    });\n\n    // Update featured array\n    Array.prototype.forEach.call(featured_input_options, function (option) {\n      let value = option.getAttribute('value');\n      if (value && value !== '' && value !== '0') {\n        let featured_item = { id: value };\n        featured.push(featured_item);\n      }\n    });\n\n    // Add new cards to featured if not already present\n    cards.forEach(function (card) {\n      let found = featured.find(featured_item => featured_item.id == card.id);\n      if (!found) {\n        let post_title = block.querySelector('.values [data-id=\"' + card.id + '\"]').textContent;\n        featured_input.insertAdjacentHTML('beforeend', `<option value=\"${card.id}\">${post_title}</option>`);\n      }\n    });\n\n    if (featured_card) {\n      // Use .val() to get the value of the ACF field\n      let selectedValue = featured_card.val();\n\n      if (selectedValue && selectedValue !== '') {\n        // Ensure featured_input is the select element and set the value\n        let optionExists = Array.from(featured_input.options).some(option => option.value === selectedValue);\n        if (optionExists) {\n          featured_input.value = selectedValue;\n        } else {\n          console.error(\"Selected value does not exist in the dropdown options.\");\n        }\n      }\n    }\n\n    // Remove any featured items not in cards\n    Array.prototype.forEach.call(featured_input_options, function (option) {\n      let value = option.getAttribute('value');\n      if (value && value !== '' && value !== '0' && !cards.find(card => card.id == value)) {\n        option.remove();\n      }\n      // If the option that's removed is the same as the featured card, remove the featured card ID from the field\n      if (value == featured_input.value && !cards.find(card => card.id == value)) {\n        featured_input.value = '';\n      }\n    });\n\n    // Save the selection to the block field\n    saveFeaturedSelection(block, featured_id, featured_input.value);\n  };\n\n  const saveFeaturedSelection = (block, featured_id, selectedValue) => {\n    let featured_card = acf.getField(featured_id);\n    if (featured_card) {\n      // Save the selected value to the block field\n      featured_card.val(selectedValue);\n    }\n  };\n\n  const acfUpdatePostSelection = (elem) => {\n    \n    if (typeof acf == 'undefined') { return; }\n\n    var cards_id = '657b1c0185c4b'; //Relationship field\n    var featured_id = '66703ce0f4c81'; // Populated select field\n    var saved_id = '6682bce463a69'; //Hidden field to save the selected card\n\n    var cards_field_id = 'field_' + cards_id;\n    var featured_field_id = 'field_' + featured_id;\n    var saved_field_id = 'field_' + saved_id;\n\n    var allHighlights = acf.findFields({ key: cards_field_id });\n\n    // If there are no highlights fields then exit\n    if (!allHighlights) { return; }\n\n    Array.prototype.forEach.call(allHighlights, function (block, i) {\n\n      // Initial update on page load\n      updateFeaturedCards(block, featured_id, saved_field_id);\n      \n      // Get the cards field\n      let cards_field = acf.getField(cards_field_id);\n      if (cards_field) {\n        // Listen for changes in the cards field\n        cards_field.on('change', function () {\n          updateFeaturedCards(block, featured_id, saved_field_id);\n        });\n      }\n\n      // If the select field changes, update the featured card\n      let featured_input = block.parentNode.querySelector('.acf-field-' + featured_id + ' .acf-input select');\n      featured_input.addEventListener('change', function () {\n        saveFeaturedSelection(block, saved_field_id, featured_input.value);\n      });\n    });\n  };\n\n  // Via https://gist.github.com/KevinBatdorf/fca19e1f3b749b5c57db8158f4850eff\n  function whenEditorIsReady() {\n    return new Promise((resolve) => {\n      const unsubscribe = subscribe(() => {\n        if (select('core/block-editor').getBlockCount() > 0) {\n          unsubscribe();\n          resolve();\n        }\n      });\n    });\n  }\n\n  // Wait for the DOM to load\n  document.addEventListener('DOMContentLoaded', function () {\n    acf.add_action('load', function () {\n      whenEditorIsReady().then(() => {\n        acfUpdatePostSelection();\n      });\n    });\n  });\n})();"],"names":["__","select","subscribe","updateFeaturedCards","block","featured_id","saved_field_id","cards","featured","cards_options","querySelectorAll","featured_input","parentNode","querySelector","featured_input_options","featured_card","acf","getField","Array","prototype","forEach","call","item","card","id","getAttribute","push","option","value","featured_item","found","find","post_title","textContent","insertAdjacentHTML","selectedValue","val","optionExists","from","options","some","console","error","remove","saveFeaturedSelection","acfUpdatePostSelection","elem","cards_id","saved_id","cards_field_id","featured_field_id","allHighlights","findFields","key","i","cards_field","on","addEventListener","whenEditorIsReady","Promise","resolve","unsubscribe","getBlockCount","document","add_action","then"],"sourceRoot":""}